#!/bin/bash

# ๐ ะกะบัะธะฟั ัะฑะพัะบะธ ะธ ัะฐะทะฒะตัััะฒะฐะฝะธั

set -e

echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "  ะกะฑะพัะบะฐ UTMN Security System"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""

# 1. ะกะฑะพัะบะฐ frontend
echo "๐ฆ ะจะฐะณ 1: ะกะฑะพัะบะฐ frontend..."
npm run build

if [ ! -d "dist" ]; then
  echo "โ ะัะธะฑะบะฐ: ะดะธัะตะบัะพัะธั dist ะฝะต ัะพะทะดะฐะฝะฐ!"
  exit 1
fi

echo "โ Frontend ัะพะฑัะฐะฝ ััะฟะตัะฝะพ"
echo ""

# 2. ะะพะดััะตั ัะฐะนะปะพะฒ
FILE_COUNT=$(find dist -type f | wc -l)
echo "๐ ะกะพะทะดะฐะฝะพ ัะฐะนะปะพะฒ: $FILE_COUNT"
echo ""

# 3. ะะพะบะฐะทะฐัั ัะฐะทะผะตั ัะฑะพัะบะธ
DIST_SIZE=$(du -sh dist | cut -f1)
echo "๐ ะะฐะทะผะตั ัะฑะพัะบะธ: $DIST_SIZE"
echo ""

# 4. ะะฝััััะบัะธะธ ะดะปั ัะฐะทะฒะตัััะฒะฐะฝะธั ะฝะฐ ัะตัะฒะตัะต
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "  โ ะกะฑะพัะบะฐ ะทะฐะฒะตััะตะฝะฐ!"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""

echo "๐ ะกะปะตะดัััะธะต ัะฐะณะธ ะดะปั ัะฐะทะฒะตัััะฒะฐะฝะธั:"
echo ""
echo "1. ะกะบะพะฟะธััะนัะต ัะฐะนะปั ะฝะฐ ัะตัะฒะตั:"
echo "   scp -r dist/* user@server:/var/www/utmn-security/frontend/"
echo ""
echo "2. ะกะบะพะฟะธััะนัะต backend (ะตัะปะธ ะธะทะผะตะฝะธะปัั):"
echo "   scp -r backend/* user@server:/var/www/utmn-security/backend/"
echo ""
echo "3. ะะตัะตะทะฐะฟัััะธัะต ัะตัะฒะธั ะฝะฐ ัะตัะฒะตัะต:"
echo "   sudo systemctl restart utmn-security"
echo ""
echo "4. ะัะพะฒะตัััะต ััะฐััั:"
echo "   sudo systemctl status utmn-security"
echo ""
echo "5. ะัะบัะพะนัะต ะฟัะธะปะพะถะตะฝะธะต ะฒ ะฑัะฐัะทะตัะต ะธ ะฟัะพะฒะตัััะต ััะฝะบัะธะพะฝะฐะป"
echo ""